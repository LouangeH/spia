{% extends 'base.html' %}

{% block content %}
<section class="container py-5">
    <h2 class="text-center">Apply for Admission</h2>
    <p class="text-center">Join us for an exceptional educational experience.</p>
    
    <form method="POST" action="" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="step step-1">
          <h4><i class="fas fa-user-graduate"></i> Student Information</h4>
            <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="academic-year">Academic Year</label>
                  <select class="form-control" id="academic-year" name="academic_year" required>
                    <option value="2025">2025-2026</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="grade">Grade</label>
                  <select class="form-control" id="grade" name="grade" required>
                    <option value="2024">7th Grade</option>
                    <option value="2025">8th Grade</option>
                  </select>
                  <input type="text" class="form-control" id="grade" name="grade" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="full-name">Full Name</label>
                    <input type="text" class="form-control" id="full-name" name="full_name" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="date-of-birth">Date of Birth</label>
                    <input type="date" class="form-control" id="date-of-birth" name="date_of_birth" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="age">Age</label>
                  <input type="number" class="form-control" id="age" name="age" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="gender">Gender</label>
                  <select class="form-control" id="gender" name="gender" required>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="nationality">Nationality</label>
                  <input type="text" class="form-control" id="nationality" name="nationality" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="place-of-birth">Place of Birth</label>
                  <input type="text" class="form-control" id="place-of-birth" name="place_of_birth" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="home-address">Home Address</label>
                  <input type="text" class="form-control" id="home-address" name="home_address" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="hobbies-interests">Hobbies Interests</label>
                  <input type="text" class="form-control" id="hobbies-interests" name="hobbies_interests" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="special-skills">Special Skills</label>
                  <input type="text" class="form-control" id="special-skills" name="special_skills" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="reason-for-applying">Reason for Applying</label>
                  <input type="text" class="form-control" id="reason-for-applying" name="reason_for_applying" required>
                </div>
            </div>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>
        
        <div class="step step-2 d-none">
          <h4><i class="fas fa-book"></i> Academic Background</h4>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="previous-school">Previous School</label>
                    <input type="text" class="form-control" id="previous-school" name="previous_school" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="school-ocation">School Location</label>
                  <input type="text" class="form-control" id="school-location" name="school_location" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="last-grade">Last Grade Completed</label>
                    <input type="text" class="form-control" id="last-grade" name="last_grade_completed" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="languages-spoken">Languages Spoken</label>
                  <select class="form-control" id="languages-spoken" name="languages_spoken" required>
                    <option value="English">English</option>
                    <option value="French">French</option>
                    <option value="Others">Others</option>
                  </select>
                </div>
            </div>
            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <div class="step step-3 d-none">
          <h4>Parent/Guardian Information</h4>
          <div class="row">
              <div class="col-md-6 mb-3">
                  <label for="guardian-name">Guardian Name</label>
                  <input type="text" class="form-control" id="guardian-name" name="guardian_name" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="guardian-relationship">Guardian Relationship</label>
                <select class="form-control" id="guardian-relationship" name="guardian_relationship" required>
                  <option value="Parent">Parent</option>
                  <option value="Siblings">Siblings</option>
                  <option value="members_of_family">Others members of family</option>
                  <option value="Others">Others</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                  <label for="guardian-phone">Contact Number</label>
                  <input type="tel" class="form-control" id="guardian-phone" name="guardian_phone" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="guardian-email">E-mail</label>
                <input type="email" class="form-control {% if form.guardian_email.errors %}is-invalid{% endif %}" id="guardian-email" name="guardian_email" required>
                {% for error in form.guardian_email.errors %}
                    <div class="invalid-feedback">{{ error }}</div>
                {% endfor %}
            </div>
            <div class="col-md-6 mb-3">
              <label for="guardian-occupation">Guardian Occupation</label>
              <input type="text" class="form-control" id="guardian-occupation" name="guardian_occupation" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="guardian-employer">Guardian Employer</label>
            <input type="text" class="form-control" id="guardian-employer" name="guardian_employer" required>
        </div>
          </div>
          <button type="button" class="btn btn-secondary prev-step">Back</button>
          <button type="button" class="btn btn-primary next-step">Next</button>
      </div>

        <div class="step step-4 d-none">
          <h4><i class="fas fa-heartbeat"></i> Medical Information</h4>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="allergies">Allergies</label>
              <select class="form-control" id="allergies" name="allergies" required>
                  <option value="Peanuts">Peanuts</option>
                  <option value="Dairy">Dairy</option>
                  <option value="Gluten">Gluten</option>
                  <option value="Pollen">Pollen</option>
                  <option value="Dust">Dust</option>
                  <option value="Animal Dander">Animal Dander</option>
                  <option value="Insect Stings">Insect Stings</option>
                  <option value="Other">Other (Specify Below)</option>
              </select>
              <input type="text" class="form-control mt-2" name="other_allergy" placeholder="If other, please specify">
              </div>
              <div class="col-md-6 mb-3">
                <label for="medical-conditions">Medical Conditions</label>
                <select class="form-control" id="medical-conditions" name="medical_conditions" required>
                    <option value="Asthma">Asthma</option>
                    <option value="Diabetes">Diabetes</option>
                    <option value="Epilepsy">Epilepsy</option>
                    <option value="Hypertension">Hypertension</option>
                    <option value="Anxiety">Anxiety</option>
                    <option value="Autism">Autism</option>
                    <option value="Other">Other (Specify Below)</option>
                </select>
                <input type="text" class="form-control mt-2" name="other_condition" placeholder="If other, please specify">
              </div>
              <div class="col-md-6 mb-3">
                <label for="emergency-contact-name">Emergency Contact Name</label>
                <input type="text" class="form-control" id="emergency-contact-name" name="emergency_contact_name" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="emergency-relationship">Emergency Relationship</label>
                <select class="form-control" id="emergency-relationship" name="emergency_relationship" required>
                  <option value="Parents">Parents</option>
                  <option value="Guardian">Guardian</option>
                  <option value="Others">Others</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="emergency-phone">Emergency Phone</label>
                <input type="tel" class="form-control" id="emergency-phone" name="emergency_phone" required>
              </div>
              <div class="col-md-6 mb-3">
                  <label for="doctor-name">Doctor Name</label>
                  <input type="text" class="form-control" id="doctor-name" name="doctor_name">
              </div>
              <div class="col-md-6 mb-3">
                <label for="doctor-contact">Doctor Contact</label>
                <input type="tel" class="form-control" id="doctor-contact" name="doctor_contact">
              </div>
          </div>
          <button type="button" class="btn btn-secondary prev-step">Back</button>
          <button type="button" class="btn btn-primary next-step">Next</button>
      </div>
        
        
        
        <div class="step step-5 d-none">
            <h4>Supporting Documents (Max 200KB each)</h4>
            <div class="mb-3">
              <label for="birth-certificate file-input">Birth Certificate</label>
              <input type="file" class="form-control" id="birth-certificate" name="birth_certificate" required>
            </div>
            <div class="mb-3">
              <label for="passport-photo">Recent Passport-Sized Photograph</label>
              <input type="file" class="form-control" id="passport-photo" name="passport_photo" required>
            </div>
            <div class="mb-3">
              <label for="last-report-card">Last Report Card</label>
              <input type="file" class="form-control" id="last-report-card" name="last_report_card" required>
            </div>
            <div class="mb-3">
              <label for="transfer-letter">Transfer Letter (if applicable)</label>
              <input type="file" class="form-control" id="transfer-letter" name="transfer_letter">
            </div>
            <div class="mb-3">
              <label for="immunization-records">Immunization Records</label>
              <input type="file" class="form-control" id="immunization-records" name="immunization_records" required>
            </div>
            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <div class="step step-6 d-none">
          <h4><i class="fas fa-check-circle"></i> Application Summary</h4>
          <table class="table table-bordered">
              <tbody>
                  <tr>
                      <th>Student Name</th>
                      <td id="summary-full-name"></td>
                  </tr>
                  <tr>
                      <th>Academic Year</th>
                      <td id="summary-academic-year"></td>
                  </tr>
                  <tr>
                      <th>Grade Applying For</th>
                      <td id="summary-grade"></td>
                  </tr>
                  <tr>
                      <th>Date of Birth</th>
                      <td id="summary-date-of-birth"></td>
                  </tr>
                  <tr>
                      <th>Guardian Name</th>
                      <td id="summary-guardian-name"></td>
                  </tr>
                  <tr>
                      <th>Guardian Phone</th>
                      <td id="summary-guardian-phone"></td>
                  </tr>
                  <tr>
                      <th>Guardian Email</th>
                      <td id="summary-guardian-email"></td>
                  </tr>
                  <tr>
                      <th>Uploaded Documents</th>
                      <td id="summary-documents">
                          <i class="fas fa-times-circle text-danger"></i> No documents uploaded
                      </td>
                  </tr>
              </tbody>
          </table>
      
          <button type="button" class="btn btn-secondary prev-step">Back</button>
          <button type="submit" class="btn btn-success">Submit</button>
      </div>
    </form>
</section>


<script>
  document.addEventListener("DOMContentLoaded", function () {
      const nextButtons = document.querySelectorAll(".next-step");
      const prevButtons = document.querySelectorAll(".prev-step");
      const steps = document.querySelectorAll(".step");
  
      nextButtons.forEach((button, index) => {
          button.addEventListener("click", function () {
              steps[index].classList.add("d-none");
              steps[index + 1].classList.remove("d-none");
  
              // Fill summary when reaching the last step
              if (index === steps.length - 2) {
                  document.getElementById("summary-full-name").innerText = document.getElementById("full-name").value;
                  document.getElementById("summary-academic-year").innerText = document.getElementById("academic-year").value;
                  document.getElementById("summary-grade").innerText = document.getElementById("grade").value;
                  document.getElementById("summary-date-of-birth").innerText = document.getElementById("date-of-birth").value;
                  document.getElementById("summary-guardian-name").innerText = document.getElementById("guardian-name").value;
                  document.getElementById("summary-guardian-phone").innerText = document.getElementById("guardian-phone").value;
                  document.getElementById("summary-guardian-email").innerText = document.getElementById("guardian-email").value;
  
                  // Check if files were uploaded
                  const fileInput = document.querySelector("input[type='file']");
                  if (fileInput && fileInput.files.length > 0) {
                      document.getElementById("summary-documents").innerHTML =
                          '<i class="fas fa-check-circle text-success"></i> Documents uploaded successfully';
                  } else {
                      document.getElementById("summary-documents").innerHTML =
                          '<i class="fas fa-exclamation-triangle text-danger"></i> No documents uploaded';
                  }
              }
          });
      });
  
      prevButtons.forEach((button, index) => {
          button.addEventListener("click", function () {
              steps[index + 1].classList.add("d-none");
              steps[index].classList.remove("d-none");
          });
      });
  });
  </script>

{% endblock %}
